(function(){var g,v,l,n,d,h,k,p,b,w,z,s,A,e,q,u,o,c,j,m,r,y,a,B,E,x,f,t,D,i,C;p={OJ_WAIT:0,OJ_AC:1,OJ_PE:2,OJ_TLE:3,OJ_MLE:4,OJ_WA:5,OJ_OLE:6,OJ_CE:7,OJ_RE_SEGV:8,OJ_RE_FPE:9,OJ_RE_BUS:10,OJ_RE_ABRT:11,OJ_RE_UNKNOWN:12,OJ_RF:13,OJ_SE:14,OJ_RE_JAVA:15,OJ_JUDGING:16,OJ_RUNNING:17,OJ_REJUDGING:18};d={PUBLIC:0,PRIVATE:1,DIY:2,INVITED:3};n={PENDING:"Pending",RUNNING:"Running",ENDED:"Ended"};v={NORMAL:"0",ADMIN:"1",CONSTANT:"2"};l={NONE:0,PASS:1,FAIL:2};w=function(I,G){var H,J,F;H=g(I);J=H.attr("email");F="http://www.gravatar.com/avatar/"+(hex_md5(J))+".jpg?"+(G.size?"s="+G.size+"&":"")+""+(G.rating?"r="+G.rating+"&":"")+""+(G.image?"d="+encodeURIComponent(G.image):"");H.attr("src",F);return I};g=jQuery;g.fn.setAvatar=function(G){var F,H=this;F={size:40,image:"retro",rating:"pg"};g.extend(F,G);return this.each(function(J,I){return w(I,F)})};D=function(F,G,H){return g.ajax({type:"POST",url:F,dataType:"json",contentType:"application/json",data:JSON.stringify(G),success:H})};t=function(G,F){return Object.merge(G,F,false,function(J,I,H){if(I.constructor===Array){I.add(H)}else{I=H}return I})};i=function(F){var G;G=window.open(F,"_blank");return G.focus()};g=jQuery;g.fn.getCursorPosition=function(){if(this.lengh===0){return -1}return g(this).getSelectionStart()};g.fn.setCursorPosition=function(F){if(this.lengh===0){return this}return g(this).setSelection(F,F)};g.fn.getSelection=function(){var G,F;if(this.lengh===0){return -1}F=g(this).getSelectionStart();G=g(this).getSelectionEnd();return this[0].value.substring(F,G)};g.fn.getSelectionStart=function(){var F,H,G;if(this.lengh===0){return -1}F=this[0];H=F.value.length;if(F.createTextRange){G=document.selection.createRange().duplicate();G.moveEnd("character",F.value.length);if(G.text===""){H=F.value.length}H=F.value.lastIndexOf(G.text)}else{if(typeof F.selectionStart!=="undefined"){H=F.selectionStart}}return H};g.fn.getSelectionEnd=function(){var F,H,G;if(this.lengh===0){return -1}F=this[0];H=F.value.length;if(F.createTextRange){G=document.selection.createRange().duplicate();G.moveStart("character",-F.value.length);if(G.text===""){H=F.value.length}H=F.value.lastIndexOf(G.text)}else{if(typeof F.selectionEnd!=="undefined"){H=F.selectionEnd}}return H};g.fn.setSelection=function(H,I){var G,F;if(this.lengh===0){return this}G=this[0];if(G.createTextRange){F=G.createTextRange();F.collapse(true);F.moveEnd("character",I);F.moveStart("character",H);F.select()}else{if(G.setSelectionRange){G.focus();G.setSelectionRange(H,I)}}return this};g.fn.insertAfterCursor=function(I,H){var G,F;if(this.length===0){return this}F=this.getCursorPosition();G=this.val();G=G.insert(I,F);this.val(G);return this.setCursorPosition(F+I.length+H)};s=8;A=function(F){if(F>9){return""+F}else{return"0"+F}};q=function(F,H,G){return""+F+"/"+(A(H+1))+"."+G};z=function(G,J,I){var F,H;F="";I.times(function(K){if(K%s===0){if(K>0){F+="</tr>"}F+="<tr>"}return F+='<td value="!['+(K+1)+"]("+(q(G,K,J))+')">\n  <span><img src="'+(q(G,K,J))+'" class="img-rounded" style="width: 50px; height: 50px"/></span>\n</td>'});F+="</tr>";H='<table class="table table-bordered table-condensed">\n  <tbody>\n    '+F+"\n  </tbody>\n</table>";return H};g=jQuery;g.fn.getFormValue=function(){var G,H,F;G=g(this);H=function(I){return G.attr("type")===I||G[0].localName===I};if(H("radio")){F=g(":radio[name='"+(G.attr("name"))+"']:checked").val();if(F==="all"){F=void 0}return F}else{if(H("select")){F=G.val();if(F===-1){F=void 0}return F}else{return G.val()}}};g.fn.getFormData=function(){var F,G=this;F={};this.each(function(I,J){var Q,N,H,L,P,M,O,K;L=["submit","reset","button","image","file"];Q=g(J);H=Q.find(":input");K=[];for(M=0,O=H.length;M<O;M++){P=H[M];N=g(P);if(L.none(N.attr("type"))){K.push(F[N.attr("name")]=N.getFormValue())}else{K.push(void 0)}}return K});return F};g.fn.setFormValue=function(H){var F,G;F=g(this);G=function(I){return F.attr("type")===I||F[0].localName===I};if(G("radio")){if(H===void 0){H="all"}if(F.attr("value")===H){return F.attr("checked",true)}else{return F.attr("checked",false)}}else{if(G("select")){if(H===void 0){H=-1}return F.val(H)}else{return F.val(H)}}};g.fn.setFormData=function(F){var G=this;return this.each(function(I,J){var Q,N,H,L,P,M,O,K;L=["submit","reset","button"];Q=g(J);H=Q.find(":input");K=[];for(M=0,O=H.length;M<O;M++){P=H[M];N=g(P);if(L.none(N.attr("type"))){K.push(N.setFormValue(F[N.attr("name")]))}else{K.push(void 0)}}return K})};g.fn.resetFormData=function(){var F=this;return this.each(function(H,I){var P,M,G,K,O,L,N,J;K=["submit","reset","button"];P=g(I);G=P.find(":input");J=[];for(L=0,N=G.length;L<N;L++){O=G[L];M=g(O);if(K.none(M.attr("type"))){J.push(M.setFormValue(void 0))}else{J.push(void 0)}}return J})};g.fn.formValidate=function(J){var I,G,H,F,K=this;H={result:{result:"success"},onSuccess:function(){},onFail:function(){}};g.extend(H,J);F=H.result;G=false;if(F.result===null){alert("Unknown exception.")}else{if(F.result==="error"){alert(F.error_msg)}else{if(F.result==="success"){H.onSuccess();G=true}else{if(F.result==="field_error"){I=g(this);F.field.each(function(M){var N,L;L=I.find(":input[name='"+M.field+"']");if(L&&L.length>0){L=g(L.first());N=L.closest("div.form-group");return N.tooltip({trigger:"click",placement:"bottom",title:M.defaultMessage}).tooltip("show")}})}else{alert("Unknown exception.")}}}}if(!G){return H.onFail()}};g=jQuery;g.fn.unescapePre=function(){var F=this;return this.each(function(J,H){var G,I;G=g(H);I=("<pre>"+G[0].innerHTML+"</pre>").unescapeHTML();return G.replaceWith(g("<div>"+I+"</div>"))})};g.fn.unescapeCode=function(){var F=this;return this.each(function(J,H){var G,I;G=g(H);I="<code>"+(G[0].innerHTML.unescapeHTML())+"</code>";return G.replaceWith(I)})};g.fn.renderTable=function(){var F=this;return this.each(function(I,H){var G;G=g(H);return G.addClass("table").addClass("table-bordered").addClass("table-condensed").addClass("cdoj-markdown-table")})};g.fn.renderImage=function(){var F=this;return this.each(function(I,H){var G;return G=g(H)})};g.fn.markdown=function(){var F=this;return this.each(function(K,I){var H,G,J;H=g(I);J=H.html().trim().replace("<textarea>","").replace("</textarea>","").replace("<TEXTAREA>","").replace("</TEXTAREA>","").trim();G=g(marked(J));H.empty().append(G);H.find("code").unescapeCode();H.find("pre").unescapePre();H.find("table").renderTable();return H.find("img").renderImage()})};g=jQuery;g.fn.mathjax=function(){var F=this;MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\[","\\]"]]}});return this.each(function(H,G){return MathJax.Hub.Queue(["Typeset",MathJax.Hub,G])})};g=jQuery;g.fn.prettify=function(){var F=this;return this.find("pre").each(function(J,H){var G,I;G=g(H);if(G.attr("type")!=="no-prettify"){I=prettyPrintOne(G[0].innerText.escapeHTML());return G.empty().append(I)}})};C=function(){g('[type="markdown"]').markdown();MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\[","\\]"]]}});MathJax.Hub.Queue(["Typeset",MathJax.Hub]);return g(document.body).prettify()};u=function(){var G,F;G=location.search;G=G.substr(G.indexOf("?")+1);G=G.split("&");F={};G.each(function(H,I){H=H.split("=");if(H.length===2){return F[H[0]]=H[1]}});return F};h=(function(){function F(G){this.options=G;this.element=this.options.element;if(this.element===null||this.element.length===0){return null}this.createTextarea();this.toolbar()}F.prototype.escape=function(G){return G};F.prototype.createTextarea=function(){var G,H;G=this.element[0].innerHTML.trim();this.element.empty();H='<div class="panel panel-default">\n  <div class="panel-heading" id="flandre-heading">\n    <div class="btn-toolbar" role="toolbar">\n      <div class="btn-group">\n        <button type="button" class="btn btn-default btn-sm" id="tool-preview">Preview</button>\n      </div>\n      <div class="btn-group flandre-tools">\n        <a class="btn btn-default btn-sm" id="tool-emotion"><i class="fa fa-smile-o"></i></a>\n        <a class="btn btn-default btn-sm" id="tool-picture"><i class="fa fa-picture-o"></i></a>\n      </div>\n    </div>\n  </div>\n  <textarea class="tex2jax_ignore form-control" id="flandre-editor">'+(this.escape(G))+'</textarea>\n  <div id="flandre-preview"></div>\n</div>';return this.element.append(H)};F.prototype.toolbar=function(){var M,K,O,H,Q,J,N,I,P,G,L=this;M=this.element.find("#flandre-editor");N=this.element.find("#flandre-preview");Q=this.options;M.elastic();G=this.element.find("#tool-preview");G.click(function(T){var R,S,U;R=g(T.currentTarget);S=R.hasClass("active");M.css("display","none");N.css("display","none");if(S){M.css("display","block");L.element.find(".flandre-tools").css("display","block")}else{U=M.val().escapeHTML();N.empty().append(U);N.markdown();N.prettify();N.mathjax();N.css("display","block");L.element.find(".flandre-tools").css("display","none")}return R.button("toggle")});I=this.element.find("#tool-emotion");O="emotion-modal-"+(this.element.attr("id"));H='<div class="modal fade" id="'+O+'" tabindex="-1" role="dialog" aria-hidden="true">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n        <h4 class="modal-title">\n          <ul class="nav nav-pills">\n            <li class="active"><a href="#emotion-brd" data-toggle="tab">BRD</a></li>\n          </ul>\n        </h4>\n      </div>\n      <div class="modal-body">\n        <div id="emotion-dialog" style="width: auto;" value="false">\n          <div class="tab-content">\n            <div class="tab-pane active" id="emotion-brd">\n              '+(z("/plugins/cdoj/img/emotion/brd","gif",40))+"\n            </div>\n          </div>\n        </div>\n      </div>\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->";g(document.body).append(H);K=g("#"+O);I.click(function(){return K.modal("show")});K.on("shown.bs.modal",function(){var R=this;return K.find("#emotion-dialog").find("td").on("click",function(U){var S,T;S=g(U.currentTarget);T=S.attr("value");M.insertAfterCursor(T,0);return K.modal("hide")})});P=this.element.find("#tool-picture");return J=new qq.FineUploaderBasic({button:P[0],request:{endpoint:Q.picture.uploadUrl,inputName:"uploadFile"},validation:{allowedExtensions:["jpeg","jpg","gif","png"],sizeLimit:10*1024*1024},multiple:false,callbacks:{onComplete:function(U,T,S){var R;if(S.success==="true"){R="!["+S.uploadedFile+"]("+S.uploadedFileUrl+")";return M.insertAfterCursor(R,0)}else{return console.log(S)}}}})};F.prototype.getText=function(){return this.element.find("#flandre-editor").val()};return F})();g=jQuery;g.fn.flandre=function(F){var G;if(F!==void 0){F.element=g(this)}else{F={element:g(this)}}G=new h(F);return G};b=(function(){function F(I){var J,M,H,G,K,L=this;this.father=I;this.search=this.father.searchGroup;K=this.father.options.condition;H=this.search.find("#condition");M=H.find("#search-button");J=H.find("#reset-button");M.click(function(){var N;N=Object.merge(K,H.getFormData());L.father.options.condition=N;L.father.refresh(N);L.close();return false});J.click(function(){H.resetFormData();return false});G=H.find("#rejudge-button");if(G.length>0){G.click(function(){var N;N=Object.merge(K,H.getFormData());D("/status/count",N,function(O){if(O.result==="success"){if(confirm("Rejudge all "+O.count+" records")){return D("/status/rejudge",N,function(P){if(P.result==="success"){return alert("Done!")}else{return alert(P.error_msg)}})}}else{return alert(O.error_msg)}});L.father.options.condition=N;L.father.refresh(N);L.close();return false})}}F.prototype.set=function(H){var G;G=this.search.find("#condition");return G.setFormData(H)};F.prototype.close=function(){var G;G=this.search.find("#advanced");return G.dropdown("toggle")};return F})();k=(function(){function F(H){var I,G;this.options=H;this.listContainer=this.options.listContainer;this.searchGroup=this.listContainer.find("#advance-search");this.searchModule=new b(this);this.pageInfo=this.listContainer.find("#page-info");this.refreshLock=0;I=u();this.searchModule.set(I);this.options.condition=t(this.options.condition,I);this.refresh(this.options.condition);G=this;if(this.options.autoRefresh===true){setInterval(function(){return G.triggerRefresh()},this.options.refreshInterval===void 0?1000:this.options.refreshInterval)}}F.prototype.triggerRefresh=function(){return this.refresh(this.options.condition)};F.prototype.refresh=function(H){var G=this;if(this.refreshLock===0){this.refreshLock=1;this.list=this.listContainer.find("#list-container");D(this.options.requestUrl,H,function(I){G.pageInfo.empty();if(I.pageInfo!==void 0){G.pageInfo.append(I.pageInfo);G.pageInfo.find("a").click(function(K){var J;J=g(K.currentTarget);if(J.attr("href")===void 0){return false}H.currentPage=J.attr("href");G.refresh(H);return false})}G.list.empty();I.list.each(function(J){return G.list.append(G.options.formatter(J))});if(G.options.after!==void 0){G.options.after()}return G.refreshLock=0})}};return F})();m=function(){var G,H,K,M,L,F,Q,P,N,I,O,J;H=g("#cdoj-navbar");G=g("#cdoj-container");M=H.find("#cdoj-user");K=H.find("#cdoj-navbar-menu");F=G.find("#mzry1992-header");L=G.find("#mzry1992-container");if(F.length!==0&&L.length!==0){L.css("margin-top",F.outerHeight())}Q=window.location.pathname;P="home";J=["problem","contest","status","user","admin"];for(I=0,O=J.length;I<O;I++){N=J[I];if(Q.startsWith("/"+N+"/")){P=N}}return K.find("#menu-item-"+P).addClass("cdoj-menu-selected")};o=function(){var I,G,F,H,J=this;I=g("#article-editor");if(I.length>0){G=g("#article-editor-title").attr("value");H=["content"];F=[];H.each(function(K,L){return F.push({id:K,editor:g("#"+K).flandre({picture:{uploadUrl:"/picture/uploadPicture/article/"+G}})})});return g("#submit").click(function(){var K;K={sampleInput:g("textarea#sample-input").val(),sampleOutput:g("textarea#sample-output").val(),title:g("#title").val(),source:g("#source").val()};F.each(function(L,M){return K[L.id]=L.editor.getText()});if(G==="new"){K.action="new"}else{K.action="edit";K.articleId=G}D("/article/edit",K,function(L){if(L.result==="success"){return window.location.href="/article/show/"+L.articleId}else{if(L.result==="field_error"){return alert("Please enter a valid title!")}else{return alert(L.error_msg)}}});return false})}};j=function(){var I,L,Q,P,J,M,R,K,F,H,N,G,O=this;I=g("#contest-show");if(I.length>0){Q=g("#contest-title").attr("value");F=g("#contest-current-time").attr("value");G=g("#contest-start-time").attr("value");N=g("#contest-end-time").attr("value");K=g("#contest-type").attr("value");J=g("#contest-status").attr("value");R=g("#contest-show-tab");P=g("#contest-problem-summary");M=R.find("a[href='#tab-contest-status']");L=g("#contest-progress-bar");if(J===n.PENDING){}else{if(J===n.RUNNING){}else{if(J===n.ENDED){L.addClass("progress-bar-success").css("width","100%")}}}P.find("a").click(function(V){var T,S,U;T=g(V.currentTarget);S=T.attr("href");if(S.startsWith("#")){U=R.find("a[href='"+S+"']");if(U.length>0){U.tab("show")}return false}else{return true}});H=e();if(H.userLogin){g("#submit-code").click(function(){var S;S={codeContent:g("#code-content").val(),languageId:g(":radio[name='language']:checked").attr("value"),contestId:Q,problemId:g("#problem-selector").find("option:selected").val()};D("/status/submit",S,function(T){if(T.result==="error"){return alert(T.error_msg)}else{if(T.result==="success"){return M.tab("show")}}});return false})}initContestStatusList(Q)}};c=function(){var F,G;F=g("#contest-list");if(F.length!==0){return G=new k({listContainer:F,requestUrl:"/contest/search",condition:{currentPage:null,startId:void 0,endId:void 0,keyword:void 0,title:void 0,orderFields:"id",orderAsc:"false"},formatter:function(I){var H;console.log(I);this.user=e();H=function(){var J;J="";if(this.user.userLogin&&this.user.currentUserType===v.ADMIN){J+='<div class="btn-toolbar" role="toolbar">\n  <div class="btn-group">\n    <button type="button" class="btn btn-default btn-sm contest-visible-state-editor" contest-id="'+I.contestId+'" visible="'+I.isVisible+'">\n      <i class="'+(I.isVisible?"fa fa-eye":"fa fa-eye-slash")+'"></i>\n    </button>\n    <button type="button" class="btn btn-default btn-sm contest-editor" contest-id="'+I.contestId+'"><i class="fa fa-pencil"></i></button>\n  </div>\n</div>'}return J};return'<div class="col-md-12">\n  <div class="panel panel-default">\n    <div class="panel-heading">\n      <h3 class="panel-title">\n        <a href="/contest/show/'+I.contestId+'" target="_blank">'+I.title+"</a>\n        <span class='pull-right admin-span'>"+(H())+'</span>\n      </h3>\n    </div>\n    <div class="panel-body">\n      <span>'+(Date.create(I.time).format("{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"))+"--"+(Date.create(I.time+I.length*1000).format("{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"))+"</span>\n    </div>\n  </div>\n</div>"},after:function(){var H=this;this.user=e();if(this.user.userLogin&&this.user.currentUserType===v.ADMIN){g(".contest-editor").click(function(J){var I;I=g(J.currentTarget);i("/contest/editor/"+(I.attr("contest-id")));return false});return g(".contest-visible-state-editor").click(function(J){var I,L,K;I=g(J.currentTarget);K=I.attr("visible")==="true"?true:false;L="/contest/operator/"+(I.attr("contest-id"))+"/isVisible/"+(!K);g.post(L,function(M){if(M.result==="success"){K=!K;I.attr("visible",K);return I.empty().append('<i class="'+(K?"fa fa-eye":"fa fa-eye-slash")+'"></i>')}});return false})}}})}};r=function(){var J,H,F,G,I=this;H=g("#problem-data-editor");if(H.length>0){G=H.find("#problem-data-editor-title").attr("value");H.find("#submit").click(function(){var K,L;K=H.find("#problem-data-form");L=K.getFormData();L.problemId=G;D("/problem/updateProblemData",L,function(M){return K.formValidate({result:M,onSuccess:function(){return window.location.href="/problem/show/"+G}})});return false});J=H.find("#problem-data-uploader");return F=new qq.FineUploaderBasic({button:J[0],request:{endpoint:"/problem/uploadProblemDataFile/"+G,inputName:"uploadFile"},validation:{allowedExtensions:["zip"],sizeLimit:100*1000*1000},multiple:false,callbacks:{onComplete:function(N,M,L){var K;if(L.success==="true"){K='<div class="alert alert-success">\n  Total data: '+L.total+"\n</div>"}else{K='<div class="alert alert-danger">\n  '+L.error+"\n</div>"}return H.find("#uploader-info").empty().append(K)},onProgress:function(O,N,L,M){var K;K='<div class="alert alert-info">\n  '+L+" bytes of "+M+"\n</div>";return H.find("#uploader-info").empty().append(K)},onError:function(M,L,K){return alert(K)}}})}};y=function(){var I,G,F,H,J=this;I=g("#problem-editor");if(I.length>0){G=g("#problem-editor-title").attr("value");H=["description","input","output","hint"];F=[];H.each(function(K,L){return F.push({id:K,editor:g("#"+K).flandre({picture:{uploadUrl:"/picture/uploadPicture/problem/"+G}})})});return g("#submit").click(function(){var K;K={sampleInput:g("textarea#sample-input").val(),sampleOutput:g("textarea#sample-output").val(),title:g("#title").val(),source:g("#source").val()};F.each(function(L,M){return K[L.id]=L.editor.getText()});if(G==="new"){K.action="new"}else{K.action="edit";K.problemId=G}D("/problem/edit",K,function(L){if(L.result==="success"){return window.location.href="/problem/show/"+L.problemId}else{if(L.result==="field_error"){return alert("Please enter a valid title!")}else{return alert(L.error_msg)}}});return false})}};a=function(){var G,F,I,H,J=this;if(g("#problem-show").length>0){G=g("#currentUser");this.userLogin=G.length!==0?true:false;I=g("#problem-title").attr("value");if(this.userLogin){g("#submit-code").click(function(){var K;K={codeContent:g("#code-content").val(),languageId:g(":radio[name='language']:checked").attr("value"),contestId:null,problemId:I};D("/status/submit",K,function(L){if(L.result==="error"){return alert(L.error_msg)}else{if(L.result==="success"){return window.location.href="/status/list"}}});return false})}F=g("#cdoj-best-solutions");if(F.length!==0){return H=new k({listContainer:F,requestUrl:"/status/search",condition:{currentPage:null,countPerPage:10,startId:void 0,endId:void 0,userName:void 0,problemId:I,languageId:void 0,contestId:void 0,result:"OJ_AC",orderFields:"timeCost,memoryCost,Length,statusId",orderAsc:"true,true,true,true"},formatter:function(N){var K,L,M,O;M=function(Q,P){return'<td style="text-align: center;">'+P+' KB</td>\n<td style="text-align: center;">'+Q+" MS</td>"};K=e();O=function(Q,P,S,R){if(P===7){if(K.userLogin&&(K.currentUserType==="1"||K.currentUser===R)){return'<a href="#" value="'+S+'" class="ce-link">'+Q+"</a>"}else{return Q}}else{return Q}};L=function(P,S,R,Q){if(K.userLogin&&(K.currentUserType==="1"||K.currentUser===Q)){return'<a href="#" value="'+R+'" class="code-link">'+P+" B</a>"}else{return""+P+" B"}};return'<tr>\n  <td style="text-align: center;">'+N.statusId+'</td>\n  <td style="text-align: center;"><a href="/user/center/'+N.userName+'" target="_blank">'+N.userName+"</a></td>\n\n  "+(N.returnTypeId===1?M(N.timeCost,N.memoryCost):"<td></td><td></td>")+'\n\n  <td style="text-align: center;">'+N.language+'</td>\n\n  <td style="text-align: center;">'+(L(N.length,N.language,N.statusId,N.userName))+'</td>\n  <td style="text-align: center;">'+(Date.create(N.time).format("{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}"))+"</td>\n  <td></td>\n</tr>"},after:function(){var K=this;return g(".code-link").click(function(M){var L,N;L=g(M.currentTarget);N=L.attr("value");g.post("/status/info/"+N,function(Q){var O,P;P="";if(Q.result==="success"){P=Q.code}else{P=Q.error_msg}P=P.trim().escapeHTML();console.log(P);O=g("#code-modal");O.find(".modal-body").empty().append("<pre>"+P+"</pre>");O.find(".modal-body").prettify();return O.modal("toggle")});return false})}})}}};B=function(){var F=this;g(".dropdown-menu").find("form").click(function(G){return G.stopPropagation()});return g("img[type='avatar']").each(function(I,H){var G;G=g(H);return G.setAvatar({size:G.width()?G.width():void 0})})};x=function(){var F,G=this;F=g("#cdoj-activation-form");if(F.length!==0){return F.find("#submit-button").click(function(){var H;H=F.getFormData();D("/user/resetPassword",H,function(I){return F.formValidate({result:I,onSuccess:function(){alert("Success!");return window.location.href="/"}})});return false})}};e=function(){var F;F=g("#currentUser");this.userLogin=F.length!==0?true:false;if(this.userLogin){this.currentUser=F[0].innerHTML.trim();this.currentUserType=F.attr("type");return{userLogin:true,currentUser:this.currentUser,currentUserType:this.currentUserType}}else{return{userLogin:false}}};E=function(){var F=this;this.user=e();if(this.user.userLogin===false){g("#cdoj-login-button").click(function(){var G,H;G=g("#cdoj-login-form");H=G.getFormData();D("/user/login",H,function(I){return G.formValidate({result:I,onSuccess:function(){return window.location.reload()}})});return false});g("#cdoj-register-button").click(function(){var H,G;H=g("#cdoj-register-form");G=H.getFormData();D("/user/register",G,function(I){return H.formValidate({result:I,onSuccess:function(){return window.location.reload()}})});return false});g("#cdoj-activate-button").click(function(){var G,H;G=g("#cdoj-activate-form");H=G.getFormData();g.post("/user/sendSerialKey/"+H.userName,function(I){if(I.result==="success"){alert("We send you an Email with the url to reset your password right now, please check your mail box.");return g("#cdoj-activate-modal").modal("hide")}else{if(I.result==="failed"){return alert("Unknown error occurred.")}else{return alert(I.error_msg)}}});return false})}if(this.user.userLogin){g("#cdoj-logout-button").click(function(){g.post("/user/logout",function(G){if(G.result==="success"){return window.location.reload()}});return false});return g("#cdoj-profile-edit-button").click(function(){var H,G;H=g("#cdoj-profile-edit-form");G=H.getFormData();if(G.newPassword===""){delete G.newPassword}if(G.newPasswordRepeat===""){delete G.newPasswordRepeat}D("/user/edit",G,function(I){return H.formValidate({result:I,onSuccess:function(){return window.location.reload()}})});return false})}};f=function(){var G,F;G=g("#user-list");if(G.length!==0){return F=new k({listContainer:G,requestUrl:"/user/search",condition:{currentPage:null,startId:void 0,endId:void 0,userName:void 0,type:void 0,school:void 0,departmentId:void 0,orderFields:"solved,tried,id",orderAsc:"false,false,true"},formatter:function(I){var H;H=function(){var J;J="";if(this.user.userLogin&&this.user.currentUserType===v.ADMIN){J+='<div class="btn-toolbar" role="toolbar" style="position: absolute; top: 12px; right: 30px;">\n      <div class="btn-group">\n        <button type="button" class="btn btn-default btn-sm admin-profile-edit" user-name="'+I.userName+'">\n          <i class="fa fa-pencil"></i>\n        </button>\n      </div>\n    </div>'}return J};return'<div class="col-lg-6">\n  <div class="panel panel-default">\n    <div class="panel-body">\n      <div class="media">\n        <a class="pull-left" href="#">\n          <img id="cdoj-users-avatar" email="'+I.email+'"/>\n        </a>\n        <div class="media-body">\n          <h4 class="media-heading"><a href="/user/center/'+I.userName+'" target="_blank">'+I.nickName+" <small>"+I.userName+'</small></a></h4>\n          <span><i class="fa fa-map-marker"></i>'+I.school+'</span>\n          <br/>\n          <span><a href="/status/list?userName='+I.userName+'" target="_blank">'+I.solved+"/"+I.tried+"</a></span>\n          "+(H())+'\n        </div>\n      </div>\n    </div>\n    <div class="panel-footer" style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">Motto: '+I.motto+"</div>\n  </div>\n</div>"},after:function(){var H,J,I,K=this;g("img#cdoj-users-avatar").setAvatar({size:64});I=g("#cdoj-admin-profile-edit-modal");H=g("#cdoj-admin-profile-edit-form");J=g("#cdoj-admin-profile-edit-form-onloading");g(".admin-profile-edit").click(function(N){var L,M;L=g(N.currentTarget);I.modal();M=L.attr("user-name");g.post("/user/secretProfile/"+M,function(O){console.log(O);H.setFormData(O.user);H.css("display","block");return J.css("display","none")});I.on("hidden.bs.modal",function(){H.css("display","none");return J.css("display","block")});return false});return g("#cdoj-admin-profile-edit-button").click(function(){var L;L=H.getFormData();if(L.newPassword===""){delete L.newPassword}if(L.newPasswordRepeat===""){delete L.newPasswordRepeat}D("/user/adminEdit",L,function(M){return H.formValidate({result:M,onSuccess:function(){I.modal("hide");return F.triggerRefresh()}})});return false})}})}};g=jQuery;g(function(){B();m();f();x();a();y();r();j();o();return C()})}).call(this);